{% extends 'base.html' %}

{% load static %}
{% block title %}
  Project Analyze
{% endblock title %}

{% block content %}

  <div class="col-lg-12">
    <div class="card">
      <div class="card-header">
        <h4 class="card-title">Проекты</h4>
      </div>
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-bordered verticle-middle table-responsive-sm">
            <thead>
            <tr>
              <th scope="col">№</th>
              <th scope="col">Наименование</th>
              <th scope="col">Ответственный</th>
              <th scope="col">Департамент</th>
              <th scope="col">Выполнимость проекта</th>
              <th scope="col">Дедлайн</th>
              <th scope="col">Статус</th>
              <th scope="col">Проектная стоимость</th>
              <th scope="col">Фактическая стоимость</th>
              <th scope="col">Ставнение</th>
            </tr>
            </thead>
            <tbody>
            {% for project in object_list %}
              <tr>
                <td>{{ forloop.counter }}</td>
                <td><strong>{{ project.name }}</strong></td>
                <td>{{ project.created_by }}</td>
                <td>{{ project.created_by.deportment }}</td>
                <td>
                  <div class="progress" style="background: rgba(127, 99, 244, .1);height: 25px">
                    <div class="progress-bar bg-primary" role="progressbar" style="width: {{ project.completed_status }} %;" aria-valuenow="{{ project.completed_status }}"
                         aria-valuemin="0" aria-valuemax="100">{{ project.completed_status }}%
                    </div>
                  </div>
                </td>
                <td>{{ project.project_plan.finish_time|date:"d-m-Y" }}</td>
                {% if project.project_status == 3 %}
                  <td><span class="badge badge-primary">{{ project.get_project_status_display }}</span></td>
                {% elif project.project_status == 4 %}
                  <td><span class="badge badge-success">{{ project.get_project_status_display }}</span></td>
                {% elif project.project_status == 5 %}
                  <td><span class="badge badge-danger">{{ project.get_project_status_display }}</span></td>
                {% elif project.project_status == 6 %}
                  <td><span class="badge badge-dark">{{ project.get_project_status_display }}</span></td>
                {% endif %}

                <td><strong>{{ project.project_plan.total_price_with_additional_cost|floatformat:"2g" }} сўм</strong></td>
                <td><strong>{{ project.total_price_with_additional_cost|floatformat:"2g" }} сўм</strong></td>
                {% if project.plan_fact_difference > 0 %}
                  <td class="text-success"><strong>{{ project.plan_fact_difference|floatformat:"2g" }} сўм</strong></td>
                {% else %}
                  <td class="text-danger"><strong>{{ project.plan_fact_difference|floatformat:"2g" }} сўм</strong></td>
                {% endif %}

              </tr>
            {% endfor %}

            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>




{% endblock %}
